import { Component, Input, HostBinding, Inject, } from "@angular/core";
import { IgxCalendarYearDirective } from "../calendar.directives";
import { NgFor } from "@angular/common";
import { IgxCalendarViewDirective, DAY_INTERVAL_TOKEN, } from "../common/calendar-view.directive";
import { NG_VALUE_ACCESSOR } from "@angular/forms";
import { CalendarDay } from "../common/model";
import { calendarRange } from "../common/helpers";
import * as i0 from "@angular/core";
export class IgxYearsViewComponent extends IgxCalendarViewDirective {
    #standalone;
    /**
     * @hidden @internal
     */
    get standalone() {
        return this.#standalone;
    }
    set standalone(value) {
        this.#standalone = value;
    }
    /**
     * Gets the year format option of the years view.
     * ```typescript
     * let yearFormat = this.yearsView.yearFormat.
     * ```
     */
    get yearFormat() {
        return this._yearFormat;
    }
    /**
     * Sets the year format option of the years view.
     * ```html
     * <igx-years-view [yearFormat]="numeric"></igx-years-view>
     * ```
     *
     * @memberof IgxYearsViewComponent
     */
    set yearFormat(value) {
        this._yearFormat = value;
        this.initFormatter();
    }
    /**
     * Returns an array of date objects which are then used to properly
     * render the years.
     *
     * Used in the template of the component.
     *
     * @hidden @internal
     */
    get range() {
        const year = this.date.getFullYear();
        const start = new CalendarDay({
            year: Math.floor(year / this._yearsPerPage) * this._yearsPerPage,
            month: this.date.getMonth(),
        });
        const end = start.add(this.dayInterval, this._yearsPerPage);
        return Array.from(calendarRange({ start, end, unit: this.dayInterval })).map((m) => m.native);
    }
    constructor(el, dayInterval) {
        super(dayInterval);
        this.el = el;
        this.#standalone = true;
        /**
         * The default css class applied to the component.
         *
         * @hidden
         */
        this.viewClass = true;
        /**
         * @hidden
         */
        this._yearFormat = "numeric";
        /**
         * @hidden
         */
        this._yearsPerPage = 15;
    }
    /**
     * Returns the locale representation of the year in the years view.
     *
     * @hidden
     */
    formattedYear(value) {
        const rawFormatter = new Intl.DateTimeFormat(this.locale, { year: 'numeric' });
        if (this.formatView) {
            return {
                long: rawFormatter.format(value),
                formatted: this._formatter.format(value)
            };
        }
        return {
            long: rawFormatter.format(value),
            formatted: `${value.getFullYear()}`
        };
    }
    /**
     * @hidden
     */
    yearTracker(_, item) {
        return `${item.getFullYear()}}`;
    }
    /**
     * @hidden
     */
    initFormatter() {
        this._formatter = new Intl.DateTimeFormat(this._locale, {
            year: this.yearFormat,
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.4", ngImport: i0, type: IgxYearsViewComponent, deps: [{ token: i0.ElementRef }, { token: DAY_INTERVAL_TOKEN }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "18.2.4", type: IgxYearsViewComponent, isStandalone: true, selector: "igx-years-view", inputs: { standalone: "standalone", yearFormat: "yearFormat" }, host: { properties: { "class.igx-calendar-view": "this.viewClass", "class.igx-calendar-view--standalone": "this.standalone" } }, providers: [
            {
                provide: NG_VALUE_ACCESSOR,
                useExisting: IgxYearsViewComponent,
                multi: true,
            },
            {
                provide: DAY_INTERVAL_TOKEN,
                useValue: "year",
            },
        ], usesInheritance: true, ngImport: i0, template: "<div class=\"igx-calendar-view__items\" role=\"row\">\n    <span\n        igxCalendarYear\n        #item=\"igxCalendarYear\"\n        *ngFor=\"let year of range; trackBy: yearTracker\"\n        class=\"igx-calendar-view__item\"\n        role=\"gridcell\"\n        [attr.id]=\"year.getTime()\"\n        [attr.aria-label]=\"formattedYear(year).long\"\n        [attr.aria-selected]=\"item.isSelected\"\n        [attr.aria-current]=\"item.isCurrent\"\n        [value]=\"year\"\n        [date]=\"date\"\n        [showActive]=\"showActive\"\n        (itemSelection)=\"selectDate($event)\"\n    >\n        <span class=\"igx-calendar-view__item-inner\" aria-hidden=\"true\">\n            {{ formattedYear(year).formatted }}\n        </span>\n    </span>\n</div>\n", dependencies: [{ kind: "directive", type: NgFor, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: IgxCalendarYearDirective, selector: "[igxCalendarYear]", exportAs: ["igxCalendarYear"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.4", ngImport: i0, type: IgxYearsViewComponent, decorators: [{
            type: Component,
            args: [{ providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: IgxYearsViewComponent,
                            multi: true,
                        },
                        {
                            provide: DAY_INTERVAL_TOKEN,
                            useValue: "year",
                        },
                    ], selector: "igx-years-view", standalone: true, imports: [NgFor, IgxCalendarYearDirective], template: "<div class=\"igx-calendar-view__items\" role=\"row\">\n    <span\n        igxCalendarYear\n        #item=\"igxCalendarYear\"\n        *ngFor=\"let year of range; trackBy: yearTracker\"\n        class=\"igx-calendar-view__item\"\n        role=\"gridcell\"\n        [attr.id]=\"year.getTime()\"\n        [attr.aria-label]=\"formattedYear(year).long\"\n        [attr.aria-selected]=\"item.isSelected\"\n        [attr.aria-current]=\"item.isCurrent\"\n        [value]=\"year\"\n        [date]=\"date\"\n        [showActive]=\"showActive\"\n        (itemSelection)=\"selectDate($event)\"\n    >\n        <span class=\"igx-calendar-view__item-inner\" aria-hidden=\"true\">\n            {{ formattedYear(year).formatted }}\n        </span>\n    </span>\n</div>\n" }]
        }], ctorParameters: () => [{ type: i0.ElementRef }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [DAY_INTERVAL_TOKEN]
                }] }], propDecorators: { viewClass: [{
                type: HostBinding,
                args: ["class.igx-calendar-view"]
            }], standalone: [{
                type: Input
            }, {
                type: HostBinding,
                args: ['class.igx-calendar-view--standalone']
            }], yearFormat: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieWVhcnMtdmlldy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9pZ25pdGV1aS1hbmd1bGFyL3NyYy9saWIvY2FsZW5kYXIveWVhcnMtdmlldy95ZWFycy12aWV3LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lnbml0ZXVpLWFuZ3VsYXIvc3JjL2xpYi9jYWxlbmRhci95ZWFycy12aWV3L3llYXJzLXZpZXcuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNILFNBQVMsRUFDVCxLQUFLLEVBQ0wsV0FBVyxFQUVYLE1BQU0sR0FDVCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNsRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDeEMsT0FBTyxFQUNILHdCQUF3QixFQUN4QixrQkFBa0IsR0FDckIsTUFBTSxtQ0FBbUMsQ0FBQztBQUMzQyxPQUFPLEVBQXdCLGlCQUFpQixFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDekUsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRTlDLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQzs7QUFtQmxELE1BQU0sT0FBTyxxQkFBc0IsU0FBUSx3QkFBd0I7SUFDL0QsV0FBVyxDQUFRO0lBVW5COztPQUVHO0lBQ0gsSUFFUSxVQUFVO1FBQ2QsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzVCLENBQUM7SUFFSixJQUFXLFVBQVUsQ0FBQyxLQUFjO1FBQzdCLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO0lBQzdCLENBQUM7SUFZRDs7Ozs7T0FLRztJQUNILElBQ1csVUFBVTtRQUNqQixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7SUFDNUIsQ0FBQztJQUVEOzs7Ozs7O09BT0c7SUFDSCxJQUFXLFVBQVUsQ0FBQyxLQUFVO1FBQzVCLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN6QixDQUFDO0lBRUQ7Ozs7Ozs7T0FPRztJQUNILElBQVcsS0FBSztRQUNaLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDckMsTUFBTSxLQUFLLEdBQUcsSUFBSSxXQUFXLENBQUM7WUFDMUIsSUFBSSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxJQUFJLENBQUMsYUFBYTtZQUNoRSxLQUFLLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7U0FDOUIsQ0FBQyxDQUFDO1FBQ0gsTUFBTSxHQUFHLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUU1RCxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQ3hFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUNsQixDQUFDO0lBQ04sQ0FBQztJQUVELFlBQ1csRUFBYyxFQUNPLFdBQXdCO1FBRXBELEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUhaLE9BQUUsR0FBRixFQUFFLENBQVk7UUEvRXpCLGdCQUFXLEdBQUcsSUFBSSxDQUFDO1FBRW5COzs7O1dBSUc7UUFFYSxjQUFTLEdBQUcsSUFBSSxDQUFDO1FBZWpDOztXQUVHO1FBQ0ssZ0JBQVcsR0FBRyxTQUFTLENBQUM7UUFFaEM7O1dBRUc7UUFDSyxrQkFBYSxHQUFHLEVBQUUsQ0FBQztJQW9EM0IsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxhQUFhLENBQUMsS0FBVztRQUM1QixNQUFNLFlBQVksR0FBRyxJQUFJLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFDO1FBRS9FLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQ2xCLE9BQU87Z0JBQ0gsSUFBSSxFQUFFLFlBQVksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO2dCQUNoQyxTQUFTLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO2FBQzNDLENBQUE7UUFDTCxDQUFDO1FBRUQsT0FBTztZQUNILElBQUksRUFBRSxZQUFZLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQztZQUNoQyxTQUFTLEVBQUUsR0FBRyxLQUFLLENBQUMsV0FBVyxFQUFFLEVBQUU7U0FDdEMsQ0FBQTtJQUNMLENBQUM7SUFFRDs7T0FFRztJQUNJLFdBQVcsQ0FBQyxDQUFTLEVBQUUsSUFBVTtRQUNwQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUM7SUFDcEMsQ0FBQztJQUVEOztPQUVHO0lBQ08sYUFBYTtRQUNuQixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ3BELElBQUksRUFBRSxJQUFJLENBQUMsVUFBVTtTQUN4QixDQUFDLENBQUM7SUFDUCxDQUFDOzhHQXpIUSxxQkFBcUIsNENBaUZsQixrQkFBa0I7a0dBakZyQixxQkFBcUIsOFBBaEJuQjtZQUNQO2dCQUNJLE9BQU8sRUFBRSxpQkFBaUI7Z0JBQzFCLFdBQVcsRUFBRSxxQkFBcUI7Z0JBQ2xDLEtBQUssRUFBRSxJQUFJO2FBQ2Q7WUFDRDtnQkFDSSxPQUFPLEVBQUUsa0JBQWtCO2dCQUMzQixRQUFRLEVBQUUsTUFBTTthQUNuQjtTQUNKLGlEQzdCTCxxdkJBcUJBLDRDRFljLEtBQUssbUhBQUUsd0JBQXdCOzsyRkFFaEMscUJBQXFCO2tCQWpCakMsU0FBUztnQ0FDSzt3QkFDUDs0QkFDSSxPQUFPLEVBQUUsaUJBQWlCOzRCQUMxQixXQUFXLHVCQUF1Qjs0QkFDbEMsS0FBSyxFQUFFLElBQUk7eUJBQ2Q7d0JBQ0Q7NEJBQ0ksT0FBTyxFQUFFLGtCQUFrQjs0QkFDM0IsUUFBUSxFQUFFLE1BQU07eUJBQ25CO3FCQUNKLFlBQ1MsZ0JBQWdCLGNBRWQsSUFBSSxXQUNQLENBQUMsS0FBSyxFQUFFLHdCQUF3QixDQUFDOzswQkFtRnJDLE1BQU07MkJBQUMsa0JBQWtCO3lDQXhFZCxTQUFTO3NCQUR4QixXQUFXO3VCQUFDLHlCQUF5QjtnQkFROUIsVUFBVTtzQkFGakIsS0FBSzs7c0JBQ1IsV0FBVzt1QkFBQyxxQ0FBcUM7Z0JBMEJwQyxVQUFVO3NCQURwQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgICBDb21wb25lbnQsXG4gICAgSW5wdXQsXG4gICAgSG9zdEJpbmRpbmcsXG4gICAgRWxlbWVudFJlZixcbiAgICBJbmplY3QsXG59IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBJZ3hDYWxlbmRhclllYXJEaXJlY3RpdmUgfSBmcm9tIFwiLi4vY2FsZW5kYXIuZGlyZWN0aXZlc1wiO1xuaW1wb3J0IHsgTmdGb3IgfSBmcm9tIFwiQGFuZ3VsYXIvY29tbW9uXCI7XG5pbXBvcnQge1xuICAgIElneENhbGVuZGFyVmlld0RpcmVjdGl2ZSxcbiAgICBEQVlfSU5URVJWQUxfVE9LRU4sXG59IGZyb20gXCIuLi9jb21tb24vY2FsZW5kYXItdmlldy5kaXJlY3RpdmVcIjtcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBOR19WQUxVRV9BQ0NFU1NPUiB9IGZyb20gXCJAYW5ndWxhci9mb3Jtc1wiO1xuaW1wb3J0IHsgQ2FsZW5kYXJEYXkgfSBmcm9tIFwiLi4vY29tbW9uL21vZGVsXCI7XG5pbXBvcnQgdHlwZSB7IERheUludGVydmFsIH0gZnJvbSBcIi4uL2NvbW1vbi9tb2RlbFwiO1xuaW1wb3J0IHsgY2FsZW5kYXJSYW5nZSB9IGZyb20gXCIuLi9jb21tb24vaGVscGVyc1wiO1xuXG5AQ29tcG9uZW50KHtcbiAgICBwcm92aWRlcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICAgICAgICB1c2VFeGlzdGluZzogSWd4WWVhcnNWaWV3Q29tcG9uZW50LFxuICAgICAgICAgICAgbXVsdGk6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIHByb3ZpZGU6IERBWV9JTlRFUlZBTF9UT0tFTixcbiAgICAgICAgICAgIHVzZVZhbHVlOiBcInllYXJcIixcbiAgICAgICAgfSxcbiAgICBdLFxuICAgIHNlbGVjdG9yOiBcImlneC15ZWFycy12aWV3XCIsXG4gICAgdGVtcGxhdGVVcmw6IFwieWVhcnMtdmlldy5jb21wb25lbnQuaHRtbFwiLFxuICAgIHN0YW5kYWxvbmU6IHRydWUsXG4gICAgaW1wb3J0czogW05nRm9yLCBJZ3hDYWxlbmRhclllYXJEaXJlY3RpdmVdLFxufSlcbmV4cG9ydCBjbGFzcyBJZ3hZZWFyc1ZpZXdDb21wb25lbnQgZXh0ZW5kcyBJZ3hDYWxlbmRhclZpZXdEaXJlY3RpdmUgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciB7XG4gICAgI3N0YW5kYWxvbmUgPSB0cnVlO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGRlZmF1bHQgY3NzIGNsYXNzIGFwcGxpZWQgdG8gdGhlIGNvbXBvbmVudC5cbiAgICAgKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBASG9zdEJpbmRpbmcoXCJjbGFzcy5pZ3gtY2FsZW5kYXItdmlld1wiKVxuICAgIHB1YmxpYyByZWFkb25seSB2aWV3Q2xhc3MgPSB0cnVlO1xuXG4gICAgLyoqXG4gICAgICogQGhpZGRlbiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuXHRASG9zdEJpbmRpbmcoJ2NsYXNzLmlneC1jYWxlbmRhci12aWV3LS1zdGFuZGFsb25lJylcblx0cHVibGljIGdldCBzdGFuZGFsb25lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jc3RhbmRhbG9uZTtcbiAgICB9XG5cblx0cHVibGljIHNldCBzdGFuZGFsb25lKHZhbHVlOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMuI3N0YW5kYWxvbmUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcHJpdmF0ZSBfeWVhckZvcm1hdCA9IFwibnVtZXJpY1wiO1xuXG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHByaXZhdGUgX3llYXJzUGVyUGFnZSA9IDE1O1xuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgeWVhciBmb3JtYXQgb3B0aW9uIG9mIHRoZSB5ZWFycyB2aWV3LlxuICAgICAqIGBgYHR5cGVzY3JpcHRcbiAgICAgKiBsZXQgeWVhckZvcm1hdCA9IHRoaXMueWVhcnNWaWV3LnllYXJGb3JtYXQuXG4gICAgICogYGBgXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgZ2V0IHllYXJGb3JtYXQoKTogYW55IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3llYXJGb3JtYXQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgeWVhciBmb3JtYXQgb3B0aW9uIG9mIHRoZSB5ZWFycyB2aWV3LlxuICAgICAqIGBgYGh0bWxcbiAgICAgKiA8aWd4LXllYXJzLXZpZXcgW3llYXJGb3JtYXRdPVwibnVtZXJpY1wiPjwvaWd4LXllYXJzLXZpZXc+XG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiBAbWVtYmVyb2YgSWd4WWVhcnNWaWV3Q29tcG9uZW50XG4gICAgICovXG4gICAgcHVibGljIHNldCB5ZWFyRm9ybWF0KHZhbHVlOiBhbnkpIHtcbiAgICAgICAgdGhpcy5feWVhckZvcm1hdCA9IHZhbHVlO1xuICAgICAgICB0aGlzLmluaXRGb3JtYXR0ZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGFycmF5IG9mIGRhdGUgb2JqZWN0cyB3aGljaCBhcmUgdGhlbiB1c2VkIHRvIHByb3Blcmx5XG4gICAgICogcmVuZGVyIHRoZSB5ZWFycy5cbiAgICAgKlxuICAgICAqIFVzZWQgaW4gdGhlIHRlbXBsYXRlIG9mIHRoZSBjb21wb25lbnQuXG4gICAgICpcbiAgICAgKiBAaGlkZGVuIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgcmFuZ2UoKTogRGF0ZVtdIHtcbiAgICAgICAgY29uc3QgeWVhciA9IHRoaXMuZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICBjb25zdCBzdGFydCA9IG5ldyBDYWxlbmRhckRheSh7XG4gICAgICAgICAgICB5ZWFyOiBNYXRoLmZsb29yKHllYXIgLyB0aGlzLl95ZWFyc1BlclBhZ2UpICogdGhpcy5feWVhcnNQZXJQYWdlLFxuICAgICAgICAgICAgbW9udGg6IHRoaXMuZGF0ZS5nZXRNb250aCgpLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgZW5kID0gc3RhcnQuYWRkKHRoaXMuZGF5SW50ZXJ2YWwsIHRoaXMuX3llYXJzUGVyUGFnZSk7XG5cbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oY2FsZW5kYXJSYW5nZSh7IHN0YXJ0LCBlbmQsIHVuaXQ6IHRoaXMuZGF5SW50ZXJ2YWwgfSkpLm1hcChcbiAgICAgICAgICAgIChtKSA9PiBtLm5hdGl2ZSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGVsOiBFbGVtZW50UmVmLFxuICAgICAgICBASW5qZWN0KERBWV9JTlRFUlZBTF9UT0tFTikgZGF5SW50ZXJ2YWw6IERheUludGVydmFsLFxuICAgICkge1xuICAgICAgICBzdXBlcihkYXlJbnRlcnZhbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbG9jYWxlIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB5ZWFyIGluIHRoZSB5ZWFycyB2aWV3LlxuICAgICAqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHB1YmxpYyBmb3JtYXR0ZWRZZWFyKHZhbHVlOiBEYXRlKToge2xvbmc6IHN0cmluZywgZm9ybWF0dGVkOiBzdHJpbmd9IHtcbiAgICAgICAgY29uc3QgcmF3Rm9ybWF0dGVyID0gbmV3IEludGwuRGF0ZVRpbWVGb3JtYXQodGhpcy5sb2NhbGUsIHsgeWVhcjogJ251bWVyaWMnIH0pO1xuXG4gICAgICAgIGlmICh0aGlzLmZvcm1hdFZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbG9uZzogcmF3Rm9ybWF0dGVyLmZvcm1hdCh2YWx1ZSksXG4gICAgICAgICAgICAgICAgZm9ybWF0dGVkOiB0aGlzLl9mb3JtYXR0ZXIuZm9ybWF0KHZhbHVlKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxvbmc6IHJhd0Zvcm1hdHRlci5mb3JtYXQodmFsdWUpLFxuICAgICAgICAgICAgZm9ybWF0dGVkOiBgJHt2YWx1ZS5nZXRGdWxsWWVhcigpfWBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBwdWJsaWMgeWVhclRyYWNrZXIoXzogbnVtYmVyLCBpdGVtOiBEYXRlKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGAke2l0ZW0uZ2V0RnVsbFllYXIoKX19YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGluaXRGb3JtYXR0ZXIoKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1hdHRlciA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KHRoaXMuX2xvY2FsZSwge1xuICAgICAgICAgICAgeWVhcjogdGhpcy55ZWFyRm9ybWF0LFxuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCI8ZGl2IGNsYXNzPVwiaWd4LWNhbGVuZGFyLXZpZXdfX2l0ZW1zXCIgcm9sZT1cInJvd1wiPlxuICAgIDxzcGFuXG4gICAgICAgIGlneENhbGVuZGFyWWVhclxuICAgICAgICAjaXRlbT1cImlneENhbGVuZGFyWWVhclwiXG4gICAgICAgICpuZ0Zvcj1cImxldCB5ZWFyIG9mIHJhbmdlOyB0cmFja0J5OiB5ZWFyVHJhY2tlclwiXG4gICAgICAgIGNsYXNzPVwiaWd4LWNhbGVuZGFyLXZpZXdfX2l0ZW1cIlxuICAgICAgICByb2xlPVwiZ3JpZGNlbGxcIlxuICAgICAgICBbYXR0ci5pZF09XCJ5ZWFyLmdldFRpbWUoKVwiXG4gICAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwiZm9ybWF0dGVkWWVhcih5ZWFyKS5sb25nXCJcbiAgICAgICAgW2F0dHIuYXJpYS1zZWxlY3RlZF09XCJpdGVtLmlzU2VsZWN0ZWRcIlxuICAgICAgICBbYXR0ci5hcmlhLWN1cnJlbnRdPVwiaXRlbS5pc0N1cnJlbnRcIlxuICAgICAgICBbdmFsdWVdPVwieWVhclwiXG4gICAgICAgIFtkYXRlXT1cImRhdGVcIlxuICAgICAgICBbc2hvd0FjdGl2ZV09XCJzaG93QWN0aXZlXCJcbiAgICAgICAgKGl0ZW1TZWxlY3Rpb24pPVwic2VsZWN0RGF0ZSgkZXZlbnQpXCJcbiAgICA+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwiaWd4LWNhbGVuZGFyLXZpZXdfX2l0ZW0taW5uZXJcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cbiAgICAgICAgICAgIHt7IGZvcm1hdHRlZFllYXIoeWVhcikuZm9ybWF0dGVkIH19XG4gICAgICAgIDwvc3Bhbj5cbiAgICA8L3NwYW4+XG48L2Rpdj5cbiJdfQ==