import { Component, Input, Output, EventEmitter, Inject, booleanAttribute } from '@angular/core';
import { first } from 'rxjs/operators';
import { BaseToolbarDirective } from './grid-toolbar.base';
import { IgxExcelTextDirective, IgxCSVTextDirective } from './common';
import { CsvFileTypes, IgxCsvExporterOptions, IgxExcelExporterOptions } from '../../services/public_api';
import { IgxToggleDirective } from '../../directives/toggle/toggle.directive';
import { IgxToolbarToken } from './token';
import { NgIf, NgTemplateOutlet } from '@angular/common';
import { IgxIconComponent } from '../../icon/icon.component';
import { IgxRippleDirective } from '../../directives/ripple/ripple.directive';
import { IgxButtonDirective } from '../../directives/button/button.directive';
import * as i0 from "@angular/core";
import * as i1 from "../../services/public_api";
import * as i2 from "./token";
/* blazorElement */
/* wcElementTag: igc-grid-toolbar-exporter */
/* blazorIndirectRender */
/* jsonAPIManageItemInMarkup */
/* singleInstanceIdentifier */
/**
 * Provides a pre-configured exporter component for the grid.
 *
 * @remarks
 * This component still needs the actual exporter service(s) provided in the DI chain
 * in order to export something.
 *
 * @igxModule IgxGridToolbarModule
 * @igxParent IgxGridToolbarComponent
 *
 */
export class IgxGridToolbarExporterComponent extends BaseToolbarDirective {
    constructor(toolbar, excelExporter, csvExporter) {
        super(toolbar);
        this.excelExporter = excelExporter;
        this.csvExporter = csvExporter;
        /**
         * Show entry for CSV export.
         */
        this.exportCSV = true;
        /**
         * Show entry for Excel export.
         */
        this.exportExcel = true;
        /**
         * The name for the exported file.
         */
        this.filename = 'ExportedData';
        /**
         * Emitted when starting an export operation. Re-emitted additionally
         * by the grid itself.
         */
        this.exportStarted = new EventEmitter();
        /**
         * Emitted on successful ending of an export operation.
         */
        this.exportEnded = new EventEmitter();
        /**
         * Indicates whether there is an export in progress.
         */
        this.isExporting = false;
    }
    exportClicked(type, toggleRef) {
        toggleRef?.close();
        this.export(type);
    }
    /* alternateName: exportGrid */
    /**
     * Export the grid's data
     * @param type File type to export
     */
    export(type) {
        let options;
        let exporter;
        switch (type) {
            case 'csv':
                options = new IgxCsvExporterOptions(this.filename, CsvFileTypes.CSV);
                exporter = this.csvExporter;
                break;
            case 'excel':
                options = new IgxExcelExporterOptions(this.filename);
                exporter = this.excelExporter;
        }
        const args = { exporter, options, grid: this.grid, cancel: false };
        this.exportStarted.emit(args);
        this.grid.toolbarExporting.emit(args);
        this.isExporting = true;
        this.toolbar.showProgress = true;
        if (args.cancel) {
            return;
        }
        exporter.exportEnded.pipe(first()).subscribe(() => {
            this.exportEnded.emit();
            this.isExporting = false;
            this.toolbar.showProgress = false;
        });
        exporter.export(this.grid, options);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.4", ngImport: i0, type: IgxGridToolbarExporterComponent, deps: [{ token: IgxToolbarToken }, { token: i1.IgxExcelExporterService }, { token: i1.IgxCsvExporterService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "16.1.0", version: "18.2.4", type: IgxGridToolbarExporterComponent, isStandalone: true, selector: "igx-grid-toolbar-exporter", inputs: { exportCSV: ["exportCSV", "exportCSV", booleanAttribute], exportExcel: ["exportExcel", "exportExcel", booleanAttribute], filename: "filename" }, outputs: { exportStarted: "exportStarted", exportEnded: "exportEnded" }, usesInheritance: true, ngImport: i0, template: "<button [title]=\"grid?.resourceStrings.igx_grid_toolbar_exporter_button_tooltip\" [disabled]=\"isExporting\"\n    igxButton=\"outlined\" type=\"button\" igxRipple #btn (click)=\"toggle(btn, toggleRef)\">\n\n    <igx-icon family=\"default\" name=\"file_download\"></igx-icon>\n    <span #ref>\n        <ng-content></ng-content>\n    </span>\n    <span *ngIf=\"!ref.textContent.trim()\">\n        {{ grid?.resourceStrings.igx_grid_toolbar_exporter_button_label }}\n    </span>\n    <igx-icon family=\"default\" name=\"arrow_drop_down\"></igx-icon>\n</button>\n\n<div class=\"igx-grid-toolbar__dropdown\" id=\"btnExport\">\n    <ul class=\"igx-grid-toolbar__dd-list\" igxToggle #toggleRef=\"toggle\">\n        <li *ngIf=\"exportExcel\" #btnExportExcel id=\"btnExportExcel\"\n            class=\"igx-grid-toolbar__dd-list-items\" igxRipple (click)=\"exportClicked('excel', toggleRef)\">\n            <span #excel>\n                <ng-content select=[excelText],excel-text></ng-content>\n            </span>\n            <excel-text *ngIf=\"!excel.childNodes.length\">\n                {{ grid?.resourceStrings.igx_grid_toolbar_exporter_excel_entry_text}}\n            </excel-text>\n        </li>\n\n        <li *ngIf=\"exportCSV\" #btnExportCsv id=\"btnExportCsv\" class=\"igx-grid-toolbar__dd-list-items\"\n            igxRipple (click)=\"exportClicked('csv', toggleRef)\">\n            <span #csv>\n                <ng-content select=[csvText],csv-text></ng-content>\n            </span>\n            <csv-text *ngIf=\"!csv.childNodes.length\">\n                {{ grid?.resourceStrings.igx_grid_toolbar_exporter_csv_entry_text }}</csv-text>\n        </li>\n    </ul>\n</div>\n", dependencies: [{ kind: "directive", type: IgxButtonDirective, selector: "[igxButton]", inputs: ["selected", "igxButton", "igxLabel"], outputs: ["buttonSelected"] }, { kind: "directive", type: IgxRippleDirective, selector: "[igxRipple]", inputs: ["igxRippleTarget", "igxRipple", "igxRippleDuration", "igxRippleCentered", "igxRippleDisabled"] }, { kind: "component", type: IgxIconComponent, selector: "igx-icon", inputs: ["family", "name", "active"] }, { kind: "directive", type: NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: IgxToggleDirective, selector: "[igxToggle]", inputs: ["id"], outputs: ["opened", "opening", "closed", "closing", "appended"], exportAs: ["toggle"] }, { kind: "directive", type: IgxExcelTextDirective, selector: "[excelText],excel-text" }, { kind: "directive", type: IgxCSVTextDirective, selector: "[csvText],csv-text" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.4", ngImport: i0, type: IgxGridToolbarExporterComponent, decorators: [{
            type: Component,
            args: [{ selector: 'igx-grid-toolbar-exporter', standalone: true, imports: [IgxButtonDirective, IgxRippleDirective, IgxIconComponent, NgIf, IgxToggleDirective, IgxExcelTextDirective, NgTemplateOutlet, IgxCSVTextDirective], template: "<button [title]=\"grid?.resourceStrings.igx_grid_toolbar_exporter_button_tooltip\" [disabled]=\"isExporting\"\n    igxButton=\"outlined\" type=\"button\" igxRipple #btn (click)=\"toggle(btn, toggleRef)\">\n\n    <igx-icon family=\"default\" name=\"file_download\"></igx-icon>\n    <span #ref>\n        <ng-content></ng-content>\n    </span>\n    <span *ngIf=\"!ref.textContent.trim()\">\n        {{ grid?.resourceStrings.igx_grid_toolbar_exporter_button_label }}\n    </span>\n    <igx-icon family=\"default\" name=\"arrow_drop_down\"></igx-icon>\n</button>\n\n<div class=\"igx-grid-toolbar__dropdown\" id=\"btnExport\">\n    <ul class=\"igx-grid-toolbar__dd-list\" igxToggle #toggleRef=\"toggle\">\n        <li *ngIf=\"exportExcel\" #btnExportExcel id=\"btnExportExcel\"\n            class=\"igx-grid-toolbar__dd-list-items\" igxRipple (click)=\"exportClicked('excel', toggleRef)\">\n            <span #excel>\n                <ng-content select=[excelText],excel-text></ng-content>\n            </span>\n            <excel-text *ngIf=\"!excel.childNodes.length\">\n                {{ grid?.resourceStrings.igx_grid_toolbar_exporter_excel_entry_text}}\n            </excel-text>\n        </li>\n\n        <li *ngIf=\"exportCSV\" #btnExportCsv id=\"btnExportCsv\" class=\"igx-grid-toolbar__dd-list-items\"\n            igxRipple (click)=\"exportClicked('csv', toggleRef)\">\n            <span #csv>\n                <ng-content select=[csvText],csv-text></ng-content>\n            </span>\n            <csv-text *ngIf=\"!csv.childNodes.length\">\n                {{ grid?.resourceStrings.igx_grid_toolbar_exporter_csv_entry_text }}</csv-text>\n        </li>\n    </ul>\n</div>\n" }]
        }], ctorParameters: () => [{ type: i2.IgxToolbarToken, decorators: [{
                    type: Inject,
                    args: [IgxToolbarToken]
                }] }, { type: i1.IgxExcelExporterService }, { type: i1.IgxCsvExporterService }], propDecorators: { exportCSV: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], exportExcel: [{
                type: Input,
                args: [{ transform: booleanAttribute }]
            }], filename: [{
                type: Input
            }], exportStarted: [{
                type: Output
            }], exportEnded: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JpZC10b29sYmFyLWV4cG9ydGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lnbml0ZXVpLWFuZ3VsYXIvc3JjL2xpYi9ncmlkcy90b29sYmFyL2dyaWQtdG9vbGJhci1leHBvcnRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9pZ25pdGV1aS1hbmd1bGFyL3NyYy9saWIvZ3JpZHMvdG9vbGJhci9ncmlkLXRvb2xiYXItZXhwb3J0ZXIuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDakcsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQzNELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxtQkFBbUIsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUN0RSxPQUFPLEVBQ0gsWUFBWSxFQUVaLHFCQUFxQixFQUVyQix1QkFBdUIsRUFFMUIsTUFBTSwyQkFBMkIsQ0FBQztBQUNuQyxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUU5RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQzFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN6RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQztBQUM5RSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSwwQ0FBMEMsQ0FBQzs7OztB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LHFCQUFxQixtRUFBb0IsbUJBQW1COzsyRkFFakosK0JBQStCO2tCQU4zQyxTQUFTOytCQUNJLDJCQUEyQixjQUV6QixJQUFJLFdBQ1AsQ0FBQyxrQkFBa0IsRUFBRSxrQkFBa0IsRUFBRSxnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsa0JBQWtCLEVBQUUscUJBQXFCLEVBQUUsZ0JBQWdCLEVBQUUsbUJBQW1CLENBQUM7OzBCQXlDdEosTUFBTTsyQkFBQyxlQUFlO21IQWpDcEIsU0FBUztzQkFEZixLQUFLO3VCQUFDLEVBQUUsU0FBUyxFQUFFLGdCQUFnQixFQUFFO2dCQU8vQixXQUFXO3NCQURqQixLQUFLO3VCQUFDLEVBQUUsU0FBUyxFQUFFLGdCQUFnQixFQUFFO2dCQU8vQixRQUFRO3NCQURkLEtBQUs7Z0JBUUMsYUFBYTtzQkFEbkIsTUFBTTtnQkFPQSxXQUFXO3NCQURqQixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIEluamVjdCwgYm9vbGVhbkF0dHJpYnV0ZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZmlyc3QgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBCYXNlVG9vbGJhckRpcmVjdGl2ZSB9IGZyb20gJy4vZ3JpZC10b29sYmFyLmJhc2UnO1xuaW1wb3J0IHsgSWd4RXhjZWxUZXh0RGlyZWN0aXZlLCBJZ3hDU1ZUZXh0RGlyZWN0aXZlIH0gZnJvbSAnLi9jb21tb24nO1xuaW1wb3J0IHtcbiAgICBDc3ZGaWxlVHlwZXMsXG4gICAgSWd4QmFzZUV4cG9ydGVyLFxuICAgIElneENzdkV4cG9ydGVyT3B0aW9ucyxcbiAgICBJZ3hDc3ZFeHBvcnRlclNlcnZpY2UsXG4gICAgSWd4RXhjZWxFeHBvcnRlck9wdGlvbnMsXG4gICAgSWd4RXhjZWxFeHBvcnRlclNlcnZpY2Vcbn0gZnJvbSAnLi4vLi4vc2VydmljZXMvcHVibGljX2FwaSc7XG5pbXBvcnQgeyBJZ3hUb2dnbGVEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL3RvZ2dsZS90b2dnbGUuZGlyZWN0aXZlJztcbmltcG9ydCB7IEdyaWRUeXBlIH0gZnJvbSAnLi4vY29tbW9uL2dyaWQuaW50ZXJmYWNlJztcbmltcG9ydCB7IElneFRvb2xiYXJUb2tlbiB9IGZyb20gJy4vdG9rZW4nO1xuaW1wb3J0IHsgTmdJZiwgTmdUZW1wbGF0ZU91dGxldCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBJZ3hJY29uQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vaWNvbi9pY29uLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBJZ3hSaXBwbGVEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL3JpcHBsZS9yaXBwbGUuZGlyZWN0aXZlJztcbmltcG9ydCB7IElneEJ1dHRvbkRpcmVjdGl2ZSB9IGZyb20gJy4uLy4uL2RpcmVjdGl2ZXMvYnV0dG9uL2J1dHRvbi5kaXJlY3RpdmUnO1xuXG5cbmV4cG9ydCB0eXBlIElneEV4cG9ydGVyT3B0aW9ucyA9IElneENzdkV4cG9ydGVyT3B0aW9ucyB8IElneEV4Y2VsRXhwb3J0ZXJPcHRpb25zO1xuXG4vKiBqc29uQVBJQ29tcGxleE9iamVjdCAqL1xuLyogd2NBbHRlcm5hdGVOYW1lOiBFeHBvcnRlckV2ZW50QXJncyAqL1xuZXhwb3J0IGludGVyZmFjZSBJZ3hFeHBvcnRlckV2ZW50IHtcbiAgICBleHBvcnRlcjogSWd4QmFzZUV4cG9ydGVyO1xuICAgIC8qIGFsdGVybmF0ZVR5cGU6IEV4cG9ydGVyT3B0aW9uc0Jhc2UgKi9cbiAgICBvcHRpb25zOiBJZ3hFeHBvcnRlck9wdGlvbnM7XG4gICAgZ3JpZDogR3JpZFR5cGU7XG4gICAgY2FuY2VsOiBib29sZWFuO1xufVxuXG5cbi8qIGJsYXpvckVsZW1lbnQgKi9cbi8qIHdjRWxlbWVudFRhZzogaWdjLWdyaWQtdG9vbGJhci1leHBvcnRlciAqL1xuLyogYmxhem9ySW5kaXJlY3RSZW5kZXIgKi9cbi8qIGpzb25BUElNYW5hZ2VJdGVtSW5NYXJrdXAgKi9cbi8qIHNpbmdsZUluc3RhbmNlSWRlbnRpZmllciAqL1xuLyoqXG4gKiBQcm92aWRlcyBhIHByZS1jb25maWd1cmVkIGV4cG9ydGVyIGNvbXBvbmVudCBmb3IgdGhlIGdyaWQuXG4gKlxuICogQHJlbWFya3NcbiAqIFRoaXMgY29tcG9uZW50IHN0aWxsIG5lZWRzIHRoZSBhY3R1YWwgZXhwb3J0ZXIgc2VydmljZShzKSBwcm92aWRlZCBpbiB0aGUgREkgY2hhaW5cbiAqIGluIG9yZGVyIHRvIGV4cG9ydCBzb21ldGhpbmcuXG4gKlxuICogQGlneE1vZHVsZSBJZ3hHcmlkVG9vbGJhck1vZHVsZVxuICogQGlneFBhcmVudCBJZ3hHcmlkVG9vbGJhckNvbXBvbmVudFxuICpcbiAqL1xuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdpZ3gtZ3JpZC10b29sYmFyLWV4cG9ydGVyJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vZ3JpZC10b29sYmFyLWV4cG9ydGVyLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdGFuZGFsb25lOiB0cnVlLFxuICAgIGltcG9ydHM6IFtJZ3hCdXR0b25EaXJlY3RpdmUsIElneFJpcHBsZURpcmVjdGl2ZSwgSWd4SWNvbkNvbXBvbmVudCwgTmdJZiwgSWd4VG9nZ2xlRGlyZWN0aXZlLCBJZ3hFeGNlbFRleHREaXJlY3RpdmUsIE5nVGVtcGxhdGVPdXRsZXQsIElneENTVlRleHREaXJlY3RpdmVdXG59KVxuZXhwb3J0IGNsYXNzIElneEdyaWRUb29sYmFyRXhwb3J0ZXJDb21wb25lbnQgZXh0ZW5kcyBCYXNlVG9vbGJhckRpcmVjdGl2ZSB7XG5cbiAgICAvKipcbiAgICAgKiBTaG93IGVudHJ5IGZvciBDU1YgZXhwb3J0LlxuICAgICAqL1xuICAgIEBJbnB1dCh7IHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSB9KVxuICAgIHB1YmxpYyBleHBvcnRDU1YgPSB0cnVlO1xuXG4gICAgLyoqXG4gICAgICogU2hvdyBlbnRyeSBmb3IgRXhjZWwgZXhwb3J0LlxuICAgICAqL1xuICAgIEBJbnB1dCh7IHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSB9KVxuICAgIHB1YmxpYyBleHBvcnRFeGNlbCA9IHRydWU7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbmFtZSBmb3IgdGhlIGV4cG9ydGVkIGZpbGUuXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgZmlsZW5hbWUgPSAnRXhwb3J0ZWREYXRhJztcblxuICAgIC8qKlxuICAgICAqIEVtaXR0ZWQgd2hlbiBzdGFydGluZyBhbiBleHBvcnQgb3BlcmF0aW9uLiBSZS1lbWl0dGVkIGFkZGl0aW9uYWxseVxuICAgICAqIGJ5IHRoZSBncmlkIGl0c2VsZi5cbiAgICAgKi9cbiAgICBAT3V0cHV0KClcbiAgICBwdWJsaWMgZXhwb3J0U3RhcnRlZCA9IG5ldyBFdmVudEVtaXR0ZXI8SWd4RXhwb3J0ZXJFdmVudD4oKTtcblxuICAgIC8qKlxuICAgICAqIEVtaXR0ZWQgb24gc3VjY2Vzc2Z1bCBlbmRpbmcgb2YgYW4gZXhwb3J0IG9wZXJhdGlvbi5cbiAgICAgKi9cbiAgICBAT3V0cHV0KClcbiAgICBwdWJsaWMgZXhwb3J0RW5kZWQgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cbiAgICAvKipcbiAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGVyZSBpcyBhbiBleHBvcnQgaW4gcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGlzRXhwb3J0aW5nID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgQEluamVjdChJZ3hUb29sYmFyVG9rZW4pIHRvb2xiYXI6IElneFRvb2xiYXJUb2tlbixcbiAgICAgICAgcHJpdmF0ZSBleGNlbEV4cG9ydGVyOiBJZ3hFeGNlbEV4cG9ydGVyU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBjc3ZFeHBvcnRlcjogSWd4Q3N2RXhwb3J0ZXJTZXJ2aWNlLFxuICAgICkge1xuICAgICAgICBzdXBlcih0b29sYmFyKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZXhwb3J0Q2xpY2tlZCh0eXBlOiAnZXhjZWwnIHwgJ2NzdicsIHRvZ2dsZVJlZj86IElneFRvZ2dsZURpcmVjdGl2ZSkge1xuICAgICAgICB0b2dnbGVSZWY/LmNsb3NlKCk7XG4gICAgICAgIHRoaXMuZXhwb3J0KHR5cGUpO1xuICAgIH1cblxuICAgIC8qIGFsdGVybmF0ZU5hbWU6IGV4cG9ydEdyaWQgKi9cbiAgICAvKipcbiAgICAgKiBFeHBvcnQgdGhlIGdyaWQncyBkYXRhXG4gICAgICogQHBhcmFtIHR5cGUgRmlsZSB0eXBlIHRvIGV4cG9ydFxuICAgICAqL1xuICAgIHB1YmxpYyBleHBvcnQodHlwZTogJ2V4Y2VsJyB8ICdjc3YnKTogdm9pZCB7XG4gICAgICAgIGxldCBvcHRpb25zOiBJZ3hFeHBvcnRlck9wdGlvbnM7XG4gICAgICAgIGxldCBleHBvcnRlcjogSWd4QmFzZUV4cG9ydGVyO1xuXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSAnY3N2JzpcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gbmV3IElneENzdkV4cG9ydGVyT3B0aW9ucyh0aGlzLmZpbGVuYW1lLCBDc3ZGaWxlVHlwZXMuQ1NWKTtcbiAgICAgICAgICAgICAgICBleHBvcnRlciA9IHRoaXMuY3N2RXhwb3J0ZXI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdleGNlbCc6XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IG5ldyBJZ3hFeGNlbEV4cG9ydGVyT3B0aW9ucyh0aGlzLmZpbGVuYW1lKTtcbiAgICAgICAgICAgICAgICBleHBvcnRlciA9IHRoaXMuZXhjZWxFeHBvcnRlcjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFyZ3MgPSB7IGV4cG9ydGVyLCBvcHRpb25zLCBncmlkOiB0aGlzLmdyaWQsIGNhbmNlbDogZmFsc2UgfSBhcyBJZ3hFeHBvcnRlckV2ZW50O1xuXG4gICAgICAgIHRoaXMuZXhwb3J0U3RhcnRlZC5lbWl0KGFyZ3MpO1xuICAgICAgICB0aGlzLmdyaWQudG9vbGJhckV4cG9ydGluZy5lbWl0KGFyZ3MpO1xuICAgICAgICB0aGlzLmlzRXhwb3J0aW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50b29sYmFyLnNob3dQcm9ncmVzcyA9IHRydWU7XG5cbiAgICAgICAgaWYgKGFyZ3MuY2FuY2VsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBleHBvcnRlci5leHBvcnRFbmRlZC5waXBlKGZpcnN0KCkpLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmV4cG9ydEVuZGVkLmVtaXQoKTtcbiAgICAgICAgICAgIHRoaXMuaXNFeHBvcnRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMudG9vbGJhci5zaG93UHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZXhwb3J0ZXIuZXhwb3J0KHRoaXMuZ3JpZCwgb3B0aW9ucyk7XG4gICAgfVxufVxuIiwiPGJ1dHRvbiBbdGl0bGVdPVwiZ3JpZD8ucmVzb3VyY2VTdHJpbmdzLmlneF9ncmlkX3Rvb2xiYXJfZXhwb3J0ZXJfYnV0dG9uX3Rvb2x0aXBcIiBbZGlzYWJsZWRdPVwiaXNFeHBvcnRpbmdcIlxuICAgIGlneEJ1dHRvbj1cIm91dGxpbmVkXCIgdHlwZT1cImJ1dHRvblwiIGlneFJpcHBsZSAjYnRuIChjbGljayk9XCJ0b2dnbGUoYnRuLCB0b2dnbGVSZWYpXCI+XG5cbiAgICA8aWd4LWljb24gZmFtaWx5PVwiZGVmYXVsdFwiIG5hbWU9XCJmaWxlX2Rvd25sb2FkXCI+PC9pZ3gtaWNvbj5cbiAgICA8c3BhbiAjcmVmPlxuICAgICAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG4gICAgPC9zcGFuPlxuICAgIDxzcGFuICpuZ0lmPVwiIXJlZi50ZXh0Q29udGVudC50cmltKClcIj5cbiAgICAgICAge3sgZ3JpZD8ucmVzb3VyY2VTdHJpbmdzLmlneF9ncmlkX3Rvb2xiYXJfZXhwb3J0ZXJfYnV0dG9uX2xhYmVsIH19XG4gICAgPC9zcGFuPlxuICAgIDxpZ3gtaWNvbiBmYW1pbHk9XCJkZWZhdWx0XCIgbmFtZT1cImFycm93X2Ryb3BfZG93blwiPjwvaWd4LWljb24+XG48L2J1dHRvbj5cblxuPGRpdiBjbGFzcz1cImlneC1ncmlkLXRvb2xiYXJfX2Ryb3Bkb3duXCIgaWQ9XCJidG5FeHBvcnRcIj5cbiAgICA8dWwgY2xhc3M9XCJpZ3gtZ3JpZC10b29sYmFyX19kZC1saXN0XCIgaWd4VG9nZ2xlICN0b2dnbGVSZWY9XCJ0b2dnbGVcIj5cbiAgICAgICAgPGxpICpuZ0lmPVwiZXhwb3J0RXhjZWxcIiAjYnRuRXhwb3J0RXhjZWwgaWQ9XCJidG5FeHBvcnRFeGNlbFwiXG4gICAgICAgICAgICBjbGFzcz1cImlneC1ncmlkLXRvb2xiYXJfX2RkLWxpc3QtaXRlbXNcIiBpZ3hSaXBwbGUgKGNsaWNrKT1cImV4cG9ydENsaWNrZWQoJ2V4Y2VsJywgdG9nZ2xlUmVmKVwiPlxuICAgICAgICAgICAgPHNwYW4gI2V4Y2VsPlxuICAgICAgICAgICAgICAgIDxuZy1jb250ZW50IHNlbGVjdD1bZXhjZWxUZXh0XSxleGNlbC10ZXh0PjwvbmctY29udGVudD5cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgIDxleGNlbC10ZXh0ICpuZ0lmPVwiIWV4Y2VsLmNoaWxkTm9kZXMubGVuZ3RoXCI+XG4gICAgICAgICAgICAgICAge3sgZ3JpZD8ucmVzb3VyY2VTdHJpbmdzLmlneF9ncmlkX3Rvb2xiYXJfZXhwb3J0ZXJfZXhjZWxfZW50cnlfdGV4dH19XG4gICAgICAgICAgICA8L2V4Y2VsLXRleHQ+XG4gICAgICAgIDwvbGk+XG5cbiAgICAgICAgPGxpICpuZ0lmPVwiZXhwb3J0Q1NWXCIgI2J0bkV4cG9ydENzdiBpZD1cImJ0bkV4cG9ydENzdlwiIGNsYXNzPVwiaWd4LWdyaWQtdG9vbGJhcl9fZGQtbGlzdC1pdGVtc1wiXG4gICAgICAgICAgICBpZ3hSaXBwbGUgKGNsaWNrKT1cImV4cG9ydENsaWNrZWQoJ2NzdicsIHRvZ2dsZVJlZilcIj5cbiAgICAgICAgICAgIDxzcGFuICNjc3Y+XG4gICAgICAgICAgICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVtjc3ZUZXh0XSxjc3YtdGV4dD48L25nLWNvbnRlbnQ+XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8Y3N2LXRleHQgKm5nSWY9XCIhY3N2LmNoaWxkTm9kZXMubGVuZ3RoXCI+XG4gICAgICAgICAgICAgICAge3sgZ3JpZD8ucmVzb3VyY2VTdHJpbmdzLmlneF9ncmlkX3Rvb2xiYXJfZXhwb3J0ZXJfY3N2X2VudHJ5X3RleHQgfX08L2Nzdi10ZXh0PlxuICAgICAgICA8L2xpPlxuICAgIDwvdWw+XG48L2Rpdj5cbiJdfQ==